<div class="container-mt5" style='text-align: center;'>
  <h2>New document</h2>
  <form
      *ngIf="Categories"
     [formGroup]="newDocForm"
     (ngSubmit)="onSubmit(newDocForm)">
     <div class="mb-2">
       <label>
         Name:
         <input id="name" formControlName="name" placeholder="Document name">
       </label>
       <div *ngIf="newDocForm.get('name')?.invalid && (newDocForm.get('name')?.dirty || newDocForm.get('name')?.touched)" class="error-field">
         <p class="error">Please provide a name.</p>
       </div>
     </div>
     <div class="mt-2">
       <label>
         Version:
         <input id="version" formControlName="version" placeholder="Doc version">
       </label>
       <div *ngIf="newDocForm.get('version')?.invalid && (newDocForm.get('version')?.dirty || newDocForm.get('version')?.touched)">
         <p class="error">Please provide a version.</p>
       </div>
     </div>
     <div class="mt-2">
       <label>
         Author:
         <input id="author" formControlName="author" placeholder="Doc author">
       </label>
       <div *ngIf="newDocForm.get('author')?.invalid && (newDocForm.get('author')?.dirty || newDocForm.get('author')?.touched)">
         <p class="error">Please provide an author.</p>
       </div>
     </div>
     <div  class="d-flex justify-content-center mt-2">
      <label>Category: </label>

      <!-- <mat-form-field>
          <mat-select formControlName="categoryName">
          <mat-option>-- None --</mat-option>
          <mat-optgroup *ngFor="let category of Categories" [label]="category.name">
          <mat-option *ngFor="let subcategory of category.children" [value]="subcategory.id">
            {{subcategory.name}}
          </mat-option>
        </mat-optgroup>
      </mat-select>
      </mat-form-field> -->



      <!-- <select
            class="custom-select mb-3"
            formControlName="categoryName"
            >
            <option class="ng-select" *ngFor="let category of CategoriesNames" [value]="category">
              {{category}}
            </option>
          </select> -->



          <!-- <ngx-mat-tree-select-input-ngmodel
          (selectionChanged)="onSelectionChange()"
          [(select)]="selectedCategory"
          [options]="options"
          [heading] = "'Sub Categories of'"
          [placeholder]="'Select Category'"
          >
  </ngx-mat-tree-select-input-ngmodel> -->




          <!-- <mat-form-field>
            <mat-label>Select an option</mat-label>
            <mat-tree-select formControlName="categoryName" [dataSource]="CategoriesTree">
              <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
                <button mat-icon-button disabled></button>
                {{node.name}}
              </mat-tree-node>
              <mat-tree-node *matTreeNodeDef="let node; when: hasChild">
                <button mat-icon-button matTreeNodeToggle
                        [attr.aria-label]="'toggle ' + node.name">
                  <mat-icon>
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                  </mat-icon>
                </button>
                {{node.name}}
                <mat-tree-node-toggle></mat-tree-node-toggle>
              </mat-tree-node>
            </mat-tree-select>
          </mat-form-field> -->

        <select
            class="custom-select mb-3"
            formControlName="categoryName"
            [(ngModel)]="selectedCategory"
            (change)="onSelectionChange()"
            >
            <optgroup *ngFor="let category of Categories" label="{{category.name}}">
              <option class="parent" [value]="category.id">
                {{category.name}}
              </option>
              <option class="child" *ngFor="let subcategory of category.children" [value]="subcategory.id">
              {{subcategory.name}}
              </option>
            </optgroup>

          </select>


                      <!-- <ng-select [items]="Categories"
                      bindLabel="name"
                      bindValue="id"
                      [(ngModel)]="categoryId" [ngModelOptions]="{standalone: true}"
                      (change)="selectedItem()"
                      style="width: 180px;">
                      </ng-select> -->




                      <!--Using ng-option and for loop-->
                <!-- <ng-select [(ngModel)]="categoryId"
                [ngModelOptions]="{standalone: true}"
                style="width: 180px;"
                (change)="selectedItem()">
                  <ng-option *ngFor="let category of Categories" [value]="category.id">
                    {{category.name}}
                  </ng-option>
                </ng-select> -->


          <!-- <ng-select [items]="Categories"
           bindLabel="name"
           groupBy="parentId"
           [multiple]="true"
           [selectableGroup]="true"
           [(ngModel)]="selectedCategory">
    <ng-template class="ng-select" ng-optgroup-tmp let-item="item">
        {{item.parentId || 'Unnamed group'}}
    </ng-template>
</ng-select> -->

<!-- <br>
<small>Selected: {{selectedAccount | json}}</small>
<hr> -->

    </div>

    <div>
      <label>
        Text:
      </label>
      <div>
        <textarea  id="text" formControlName="text" placeholder="Doc text" rows="15" cols="150"></textarea>
      </div>

      <div *ngIf="newDocForm.get('text')?.invalid && (newDocForm.get('text')?.dirty || newDocForm.get('text')?.touched)">
        <p class="error">Please provide a text.</p>
      </div>
    </div>
    <div class="text-center">
      <button [disabled]="!newDocForm.valid" class="btn btn-success mr-5" type="submit">Save document</button>
      <button class="btn btn-default ml-5" (click)="cancel()" type="button">Cancel</button>
    </div>
      </form>
